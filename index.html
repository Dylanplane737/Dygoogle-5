<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dygoogle 5</title>
  <style>
    body {
      font-family: "Pixelify Sans", Pixelify Sans;
      background-color: #2596be;
      color: white;
      text-align: center;
      margin-top: 40px;
      transition: background-image 0.5s ease;
      background-size: cover;
      background-position: center;
    }
    input {
      padding: 10px;
      width: 500px;
      font-size: 16px;
      border-radius: 30px;
      border: 1px solid #ccc;
      margin: 10px 0;
      box-sizing: border-box;
    }
    .logo {
      font-size: 72px;
      font-weight: bold;
      color: #fff;
      margin: 20px;
    }
    button {
      padding: 15px 30px;
      font-size: 16px;
      margin: 5px;
      cursor: pointer;
      border-radius: 30px;
      border: none;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s ease-in-out;
    }
    button:hover {
      transform: scale(1.05);
    }
    .bg-buttons {
      margin-top: 30px;
    }
    .bg-upload {
      margin-top: 20px;
    }
    .bg-buttons button,
    .bg-upload button {
      border-radius: 30px;
      padding: 15px 30px;
      margin: 5px;
      background-color: #fff;
      color: #2596be;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
    }
    .bg-buttons button:hover,
    .bg-upload button:hover {
      background-color: #f0f0f0;
    }
    .bg-upload input[type="file"] {
      border-radius: 30px;
      padding: 10px;
      margin: 5px;
      background-color: #fff;
      color: #2596be;
      border: none;
    }
    .suggestions {
      position: absolute;
      width: 500px;
      max-height: 150px;
      overflow-y: auto;
      background: white;
      color: black;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      z-index: 1000;
      text-align: left;
      margin-top: 0;
      padding: 0;
    }
    .suggestions div {
      padding: 8px 15px;
      cursor: pointer;
    }
    .suggestions div:hover,
    .suggestions .highlighted {
      background-color: #2596be;
      color: white;
    }
    #resultContainer {
      display: none;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
      max-width: 1100px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 10px;
      box-sizing: border-box;
    }
    #wikiSummary, #relatedMedia {
      background: rgba(0, 0, 0, 0.3);
      padding: 20px;
      border-radius: 12px;
      color: white;
      overflow-y: auto;
      max-height: 800px;
      box-sizing: border-box;
    }
    #wikiSummary {
      width: 45%;
      text-align: left;
    }
    #wikiSummary img {
      max-width: 100%;
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    #wikiSummary h2 {
      margin-top: 0;
      margin-bottom: 10px;
    }
    #wikiSummary a {
      color: #a8d0e6;
      text-decoration: none;
    }
    #wikiSummary a:hover {
      text-decoration: underline;
    }
    #relatedMedia {
      width: 45%;
      display: flex;
      flex-direction: column;
      gap: 15px;
      text-align: left;
    }
    #relatedMedia h3 {
      margin-top: 0;
    }
    #relatedMedia .media-section {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      max-height: 320px;
      overflow-y: auto;
      background: rgba(255,255,255,0.1);
      padding: 10px;
      border-radius: 12px;
    }
    #relatedMedia img,
    #relatedMedia video {
      max-width: 400px;
      max-height: 700px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      object-fit: cover;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    #relatedMedia img:hover,
    #relatedMedia video:hover {
      transform: scale(1.1);
    }
    #dictionaryContainer {
      margin: 20px auto 40px;
      width: 520px;
      background: rgba(0,0,0,0.35);
      border-radius: 12px;
      padding: 20px;
      color: white;
      text-align: left;
      max-height: 350px;
      overflow-y: auto;
      box-sizing: border-box;
    }
    #dictionaryContainer h3 {
      margin-top: 0;
    }
    #dictionaryResults {
      margin-top: 10px;
    }
    .definition {
      margin-bottom: 15px;
    }
    .definition strong {
      color: #a8d0e6;
    }
    .phonetics {
      font-style: italic;
      margin-bottom: 10px;
      color: #c0d6e4;
    }
    .errorMsg {
      color: #ff7070;
    }
    #rickrollContainer {
      margin-top: 30px;
    }
    #rickrollContainer img {
      max-width: 500px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">Dygoogle!</div>
    <div style="position: relative; margin: 0 auto; width: 500px;">
      <input
        type="text"
        id="urlInput"
        placeholder="Search... (e.g. Yahoo.com Quickfind is powered by DylanAI 0.2.9')"
        oninput="showSuggestions(this.value)"
        autocomplete="off"
      />
      <div class="suggestions" id="suggestionBox"></div>
    </div>
    <button onclick="openWebsite()" style="padding: 20px 50px; font-size: 18px;">Open</button>
    <div id="resultContainer">
      <div id="wikiSummary"></div>
      <div id="relatedMedia">
        <h3>Related Images</h3>
        <div id="imagesSection" class="media-section"></div>
        <h3>Related Videos</h3>
        <div id="videosSection" class="media-section"></div>
      </div>
    </div>
    <div id="rickrollContainer" style="display:none;">
      <h3>Surprise!</h3>
      <img id="rickrollGif" src="https://upload.wikimedia.org/wikipedia/commons/3/3d/Rick_Astley_-_Never_Gonna_Give_You_Up.gif" alt="Rickroll GIF" />
    </div>
    <div id="dictionaryContainer" style="display:none;">
      <h3>Dictionary Lookup</h3>
      <div id="dictionaryResults"></div>
    </div>
    <div class="bg-buttons">
      <h2>Change Background</h2>
      <button onclick="changeBackground('bg1.jpg')">Background 1</button>
      <div class="bg-upload">
        <h3>Upload A Background Image</h3>
        <input
          type="file"
          id="fileInput"
          accept="image/*"
          onchange="changeBackgroundFromFile(event)"
        />
      </div>
    </div>
  </div>
<script>
  const commonSites = [
    "google.com", "youtube.com", "github.com", "stackoverflow.com",
    "openai.com", "reddit.com", "twitter.com"
  ];
  let highlightedIndex = -1;
  function formatURL(input) {
    input = input.trim().toLowerCase();
    if (input.startsWith("http://") || input.startsWith("https://")) return input;
    if (input.includes(".")) return "https://" + input;
    return input;
  }
  function showSuggestions(input) {
    const suggestionBox = document.getElementById("suggestionBox");
    suggestionBox.innerHTML = "";
    highlightedIndex = -1;
    if (!input) {
      document.getElementById("dictionaryContainer").style.display = "none";
      return;
    }
    const matches = commonSites.filter(site => site.includes(input.toLowerCase()));
    matches.forEach(site => {
      const div = document.createElement("div");
      div.textContent = site;
      div.tabIndex = 0;
      div.onclick = () => {
        document.getElementById("urlInput").value = site;
        suggestionBox.innerHTML = "";
        document.getElementById("dictionaryContainer").style.display = "none";
      };
      suggestionBox.appendChild(div);
    });
    document.getElementById("dictionaryContainer").style.display = "none";
  }
  document.getElementById("urlInput").addEventListener("keydown", function(e) {
    const suggestionBox = document.getElementById("suggestionBox");
    const items = suggestionBox.querySelectorAll("div");
    if (!items.length) return;
    if (e.key === "ArrowDown") {
      e.preventDefault();
      highlightedIndex = (highlightedIndex + 1) % items.length;
      updateHighlight(items);
    } else if (e.key === "ArrowUp") {
      e.preventDefault();
      highlightedIndex = (highlightedIndex - 1 + items.length) % items.length;
      updateHighlight(items);
    } else if (e.key === "Enter") {
      if (highlightedIndex >= 0 && highlightedIndex < items.length) {
        e.preventDefault();
        const selected = items[highlightedIndex].textContent;
        document.getElementById("urlInput").value = selected;
        suggestionBox.innerHTML = "";
        document.getElementById("dictionaryContainer").style.display = "none";
      } else {
        openWebsite();
      }
    } else if (e.key === "Escape") {
      suggestionBox.innerHTML = "";
      highlightedIndex = -1;
      document.getElementById("dictionaryContainer").style.display = "none";
    }
  });
  function updateHighlight(items) {
    items.forEach((item, i) => {
      item.classList.toggle("highlighted", i === highlightedIndex);
    });
  }
  async function getWikiSummary(query) {
    try {
      const res = await fetch(`https://en.wikipedia.org/w/api.php?action=query&origin=*&prop=extracts|pageimages&exintro&explaintext&piprop=thumbnail&pithumbsize=300&format=json&titles=${encodeURIComponent(query)}`);
      const data = await res.json();
      const pages = data.query.pages;
      const page = Object.values(pages)[0];
      if (!page || page.missing) return null;
      return {
        title: page.title,
        extract: page.extract,
        thumbnail: page.thumbnail ? page.thumbnail.source : null,
        fullurl: `https://en.wikipedia.org/wiki/${encodeURIComponent(page.title)}`
      };
    } catch {
      return null;
    }
  }
  async function getCommonsMedia(query) {
    try {
      const endpoint = `https://commons.wikimedia.org/w/api.php?action=query&origin=*&format=json&generator=search&gsrsearch=${encodeURIComponent(query)}&gsrlimit=20&gsrnamespace=6&prop=imageinfo&iiprop=url|mime|thumbmime|extmetadata&iiurlwidth=300`;
      const res = await fetch(endpoint);
      const data = await res.json();
      if (!data.query || !data.query.pages) return { images: [], videos: [] };
      const pages = Object.values(data.query.pages);
      const images = [];
      const videos = [];
      for (const page of pages) {
        if (!page.imageinfo) continue;
        const info = page.imageinfo[0];
        const mime = info.mime;
        if (mime.startsWith("image/")) {
          images.push(info.thumburl || info.url);
        } else if (mime.startsWith("video/")) {
          videos.push(info.url);
        }
      }
      return { images, videos };
    } catch {
      return { images: [], videos: [] };
    }
  }
  async function getDictionaryDefinition(word) {
    try {
      const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`);
      if (!res.ok) throw new Error("Not found");
      const data = await res.json();
      return data[0];
    } catch {
      return null;
    }
  }
  async function openWebsite() {
    const input = document.getElementById("urlInput").value.trim();
    document.getElementById("resultContainer").style.display = "none";
    document.getElementById("dictionaryContainer").style.display = "none";
    document.getElementById("rickrollContainer").style.display = "none";
    if (!input) return alert("Please enter something!");
    if (input.toLowerCase() === "rickroll") {
      document.getElementById("rickrollContainer").style.display = "block";
      return;
    }
    if (input.includes(".") || input.startsWith("http://") || input.startsWith("https://")) {
      const url = formatURL(input);
      window.open(url, "_blank");
      return;
    }
    const summary = await getWikiSummary(input);
    if (!summary) {
      alert("No Wikipedia article found for your query.");
      return;
    }
    const wikiDiv = document.getElementById("wikiSummary");
    wikiDiv.innerHTML = `
      <h2>${summary.title}</h2>
      ${summary.thumbnail ? `<img src="${summary.thumbnail}" alt="${summary.title}"/>` : ""}
      <p>${summary.extract}</p>
      <a href="${summary.fullurl}" target="_blank" rel="noopener noreferrer">Read more on Wikipedia</a>
    `;
    const media = await getCommonsMedia(input);
    const imagesSection = document.getElementById("imagesSection");
    imagesSection.innerHTML = "";
    if (media.images.length === 0) {
      imagesSection.innerHTML = "<p>No related images found.</p>";
    } else {
      media.images.forEach(src => {
        const img = document.createElement("img");
        img.src = src;
        img.alt = input;
        imagesSection.appendChild(img);
      });
    }
    const videosSection = document.getElementById("videosSection");
    videosSection.innerHTML = "";
    if (media.videos.length === 0) {
      videosSection.innerHTML = "<p>No related videos found.</p>";
    } else {
      media.videos.forEach(src => {
        const video = document.createElement("video");
        video.src = src;
        video.controls = true;
        videosSection.appendChild(video);
      });
    }
    document.getElementById("resultContainer").style.display = "flex";
    const dictData = await getDictionaryDefinition(input);
    const dictContainer = document.getElementById("dictionaryContainer");
    const dictResults = document.getElementById("dictionaryResults");
    dictResults.innerHTML = "";
    if (!dictData) {
      dictResults.innerHTML = `<p class="errorMsg">No dictionary definition found.</p>`;
      dictContainer.style.display = "block";
      return;
    }
    if (dictData.phonetics && dictData.phonetics.length) {
      const phoneticText = dictData.phonetics[0].text || "";
      if (phoneticText) {
        dictResults.innerHTML += `<p class="phonetics">Pronunciation: ${phoneticText}</p>`;
      }
    }
    dictData.meanings.forEach(meaning => {
      dictResults.innerHTML += `<h4>${meaning.partOfSpeech}</h4>`;
      meaning.definitions.forEach((def, i) => {
        dictResults.innerHTML += `
          <div class="definition">
            <strong>${i+1}.</strong> ${def.definition}
            ${def.example ? `<br><em>Example: ${def.example}</em>` : ""}
          </div>
        `;
      });
    });
    dictContainer.style.display = "block";
  }
  function changeBackground(img) {
    document.body.style.backgroundImage = `url(${img})`;
  }
  function changeBackgroundFromFile(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
      document.body.style.backgroundImage = `url(${e.target.result})`;
    };
    reader.readAsDataURL(file);
  }
</script>
</body>
</html>
